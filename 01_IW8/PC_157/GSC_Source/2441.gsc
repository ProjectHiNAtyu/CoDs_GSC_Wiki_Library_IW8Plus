// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

vehicle_occupancy_mp_init()
{
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_B90B0FBD37A23747AC2759CA43D2D8C6CA", ::vehicle_occupancy_mp_onentervehicle );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_98110E985E273AEB23216010CABEA9D1", ::vehicle_occupancy_mp_onexitvehicle );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_BA6011272BCEA59B8ECAC9A4DCB93AB037362B", ::vehicle_occupancy_mp_registerinstance );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_8F201367E235A1C9C22344B360E97D6BD31A6852EF", ::vehicle_occupancy_mp_deregisterinstance );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_B4B70CCB5007102D87F8EB30A223", ::vehicle_occupancy_mp_updateowner );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_A92B114E56762D378E954E9AACB98E9656B9A3", ::vehicle_occupancy_mp_registersentient );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_B9BC1357CDE459D9A5371DCA4EA6CA731D4B959B47", ::vehicle_occupancy_mp_unregistersentient );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_95A90B23EBD7317DBB3A98C883", ::vehicle_occupancy_mp_issentient );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_89400F47B06D9529A5DED1D4864BCA3646", ::_id_141F0 );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_A4D20FFFA0DBC7023798BBC971307A85E1", ::_id_141ED );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_8BE5112711DDFA9CC8978C154B21D8322551EB", ::_id_141F2 );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_B8BD0C344B1956682CB9A1120B76", ::_id_141EE );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_89CA0C6E34BDBB68B0DCD084853B", ::_id_141EF );
    scripts\cp_mp\utility\script_utility::registersharedfunc( "_encstr_A8EF121B4F60AFD7806DF9985E265770BFBDCA60", "_encstr_B26C0DBFE1F8826F525C61A7828940", ::_id_141EC );
    scripts\mp\playeractions::registeractionset( "_encstr_BC5008F4B573F81FC5B2", [ "_encstr_8B0508CE95DC1DEAC92B", "_encstr_B6190C6DB4C68DB9A327CA0B6DDC", "_encstr_BEF407B95DC1B227E6", "_encstr_A9760D63E1F95DDF38385BB2C0378F" ] );
    scripts\mp\playeractions::registeractionset( "_encstr_9E4512ECCA86D23663B2D70785E66EB2CDCEAC93", [ "_encstr_8B0508CE95DC1DEAC92B", "_encstr_BEF407B95DC1B227E6", "_encstr_A9760D63E1F95DDF38385BB2C0378F" ] );
    level.vehicle._id_1424E = getdvarint( "_encstr_A32313B91BC9D73B56434B368D59AFD85AEC0DE8E6", 1 );
}

vehicle_occupancy_mp_onentervehicle( var_0, var_1, var_2, var_3 )
{
    var_2 scripts\mp\utility\perk::giveperk( "_encstr_940810132B95A77438E13431EF607CCFC603" );
    var_2 scripts\mp\utility\perk::giveperk( "_encstr_9D7E19DCC1591BB4B01B1D5EBEE8C92C8D5B59277DA685B5DA5627" );
    var_4 = level.gametype == "_encstr_9507034B25";

    if ( !var_4 || scripts\cp_mp\vehicles\vehicle_occupancy::_id_141DF( var_0, var_1 ) )
        var_2 scripts\mp\playeractions::allowactionset( "_encstr_BC5008F4B573F81FC5B2", 0 );
    else if ( var_4 )
        var_2 scripts\mp\playeractions::allowactionset( "_encstr_9E4512ECCA86D23663B2D70785E66EB2CDCEAC93", 0 );

    if ( getdvar( "_encstr_A10E10BABF1EB12D4B819F18E8488BAA02E5", "_encstr_A40101" ) == "_encstr_BE180432D63D" || getdvar( "_encstr_A10E10BABF1EB12D4B819F18E8488BAA02E5", "_encstr_A40101" ) == "_encstr_89E10946E1536E6DD6A2B0" || getdvar( "_encstr_A10E10BABF1EB12D4B819F18E8488BAA02E5", "_encstr_A40101" ) == "_encstr_AD1F058082CACF" )
        _encstr_A18624E0EFEA87BAA35A56BBFB0EBF36CA096B407105AFF796F09F4F7DAFB0DCE162357947B7::_id_12781( var_2, 0, 1 );

    _id_141F0( var_2 );
    scripts\mp\outofbounds::enableoobimmunity( var_2 );

    if ( scripts\mp\outofbounds::isoob( var_0, 1 ) )
        var_0 thread scripts\mp\vehicles\vehicle_oob_mp::vehicle_oob_mp_entercallbackforplayer( var_2 );

    if ( isdefined( var_2.team ) && isdefined( var_2.squadindex ) && istrue( var_0.israllypointvehicle ) )
        thread scripts\mp\spawnselection::_id_12ACB( var_2.team, var_2.squadindex );

    if ( isdefined( level.playerconnectwatcher ) && var_2 [[ level.playerconnectwatcher ]]() )
    {
        if ( isdefined( level.playerexecutionsenable ) )
            var_2 [[ level.playerexecutionsenable ]]();
    }

    vehicle_occupancy_mp_updatemarkfilter( var_0 );
    _id_141F1( var_0 );
    _id_141F3( var_0 );
}

vehicle_occupancy_mp_onexitvehicle( var_0, var_1, var_2, var_3 )
{
    if ( !istrue( var_3.playerdisconnect ) && isdefined( var_2 ) )
    {
        if ( !istrue( var_3.playerdeath ) )
        {
            var_2 scripts\mp\utility\perk::removeperk( "_encstr_940810132B95A77438E13431EF607CCFC603" );
            var_2 scripts\mp\utility\perk::removeperk( "_encstr_9D7E19DCC1591BB4B01B1D5EBEE8C92C8D5B59277DA685B5DA5627" );
            var_4 = level.gametype == "_encstr_9507034B25";

            if ( !var_4 || scripts\cp_mp\vehicles\vehicle_occupancy::_id_141DF( var_0, var_1 ) )
                var_2 scripts\mp\playeractions::allowactionset( "_encstr_BC5008F4B573F81FC5B2", 1 );
            else if ( var_4 )
                var_2 scripts\mp\playeractions::allowactionset( "_encstr_9E4512ECCA86D23663B2D70785E66EB2CDCEAC93", 1 );

            if ( getdvar( "_encstr_A10E10BABF1EB12D4B819F18E8488BAA02E5", "_encstr_A40101" ) == "_encstr_BE180432D63D" || getdvar( "_encstr_A10E10BABF1EB12D4B819F18E8488BAA02E5", "_encstr_A40101" ) == "_encstr_89E10946E1536E6DD6A2B0" || getdvar( "_encstr_A10E10BABF1EB12D4B819F18E8488BAA02E5", "_encstr_A40101" ) == "_encstr_AD1F058082CACF" )
                _encstr_A18624E0EFEA87BAA35A56BBFB0EBF36CA096B407105AFF796F09F4F7DAFB0DCE162357947B7::_id_12781( var_2, 1, 1 );

            if ( scripts\mp\outofbounds::isoob( var_0, 1 ) )
                var_0 thread scripts\mp\vehicles\vehicle_oob_mp::vehicle_oob_mp_exitcallbackforplayer( var_2 );

            scripts\mp\outofbounds::disableoobimmunity( var_2 );
        }

        _id_141ED( var_2, var_3.playerdeath, var_3.playerlaststand );

        if ( isdefined( var_2.team ) && isdefined( var_2.squadindex ) && istrue( var_0.israllypointvehicle ) )
            thread scripts\mp\spawnselection::_id_12ACB( var_3.team, var_3.squadindex );

        if ( isdefined( level.playerconnectwatcher ) && var_2 [[ level.playerconnectwatcher ]]() )
        {
            if ( isdefined( level.playerexitcombatarea ) )
                var_2 [[ level.playerexitcombatarea ]]();
        }

        var_2 notify( "_encstr_9D130DCE2B0DA5D8C695FA95C3B48E" );
    }

    vehicle_occupancy_mp_updatemarkfilter( var_0 );
    _id_141F1( var_0 );
    _id_141F3( var_0 );
}

_id_141EC( var_0, var_1, var_2, var_3 )
{
    var_4 = level.gametype == "_encstr_9507034B25";

    if ( var_4 && isdefined( var_2 ) && isdefined( var_3 ) )
    {
        if ( scripts\cp_mp\vehicles\vehicle_occupancy::_id_141DF( var_1, var_2 ) )
        {
            var_0 scripts\mp\playeractions::allowactionset( "_encstr_BC5008F4B573F81FC5B2", 1 );
            var_0 scripts\mp\playeractions::allowactionset( "_encstr_9E4512ECCA86D23663B2D70785E66EB2CDCEAC93", 0 );
        }
        else if ( scripts\cp_mp\vehicles\vehicle_occupancy::_id_141DF( var_1, var_3 ) )
        {
            var_0 scripts\mp\playeractions::allowactionset( "_encstr_9E4512ECCA86D23663B2D70785E66EB2CDCEAC93", 1 );
            var_0 scripts\mp\playeractions::allowactionset( "_encstr_BC5008F4B573F81FC5B2", 0 );
        }
    }
}

vehicle_occupancy_mp_updatemarkfilter( var_0 )
{
    if ( !isdefined( var_0.occupants ) )
        return;

    if ( !isdefined( var_0._id_11B19 ) )
        var_0._id_11B19 = 1;

    var_1 = var_0._id_11B19;
    var_2 = scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_getalloccupants( var_0 );
    var_0._id_11B19 = var_2.size > 0;

    if ( var_1 && !var_0._id_11B19 )
        var_0 disableplayermarks( "_encstr_B6CE0B0BB00A031B7B88355740" );
    else if ( !var_1 && var_0._id_11B19 )
        var_0 enableplayermarks( "_encstr_B6CE0B0BB00A031B7B88355740" );

    if ( var_0._id_11B19 )
    {
        if ( level.teambased )
        {
            var_3 = [];

            foreach ( var_5 in var_2 )
            {
                if ( !scripts\engine\utility::array_contains( var_3, var_5.team ) )
                    var_3[var_3.size] = var_5.team;
            }

            var_0 filteroutplayermarks( var_3 );
        }
        else
            var_0 filteroutplayermarks( var_2 );
    }
}

vehicle_occupancy_mp_registerinstance( var_0 )
{

}

vehicle_occupancy_mp_deregisterinstance( var_0 )
{

}

_id_141EE( var_0, var_1, var_2, var_3 )
{
    var_4 = scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_getleveldataforseat( var_0.vehiclename, var_1 );

    if ( istrue( var_4._id_13345 ) )
        return;

    if ( isdefined( level._id_11A32 ) && scripts\engine\utility::array_contains( level._id_11A32, var_2 ) )
    {
        if ( isdefined( var_2.carriable_set_dropped ) )
        {
            stopfxontag( level._effect["_encstr_8C881546FDF0E1B306AE7A42335343278051CDCA4DD037"], var_2, "_encstr_A1480B90011609E930FAD5CBD3" );
            var_2 hidepart( "_encstr_A1480B90011609E930FAD5CBD3", "_encstr_BDD228851BB12BB9CDED4E2FAFADDE7359F2BE9858B3AFB1859376CAEBB1D8F6CD5632AF38C6C2CBB293" );
        }
    }
}

_id_141EF( var_0, var_1, var_2, var_3 )
{
    var_4 = scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_getleveldataforseat( var_0.vehiclename, var_1 );

    if ( istrue( var_4._id_13345 ) )
        return;

    if ( isdefined( level._id_11A32 ) && scripts\engine\utility::array_contains( level._id_11A32, var_2 ) )
    {
        if ( isdefined( var_2.carriable_set_dropped ) )
        {
            var_2 showpart( "_encstr_A1480B90011609E930FAD5CBD3", "_encstr_BDD228851BB12BB9CDED4E2FAFADDE7359F2BE9858B3AFB1859376CAEBB1D8F6CD5632AF38C6C2CBB293" );
            playfxontag( level._effect["_encstr_8C881546FDF0E1B306AE7A42335343278051CDCA4DD037"], var_2, "_encstr_A1480B90011609E930FAD5CBD3" );
        }
    }
}

vehicle_occupancy_mp_updateowner( var_0 )
{
    vehicle_occupancy_mp_updatemarkfilter( var_0 );
}

_id_141F0( var_0, var_1, var_2 )
{
    var_3 = undefined;
    var_4 = undefined;
    var_5 = undefined;
    var_6 = var_0 getweaponslistprimaries();

    foreach ( var_8 in var_6 )
    {
        if ( nullweapon( var_8 ) )
            continue;

        if ( scripts\mp\riotshield::isriotshield( var_8 ) )
        {
            var_3 = var_8;

            if ( isnullweapon( var_3, var_0 getcurrentprimaryweapon() ) )
                var_4 = 1;

            continue;
        }

        if ( !isdefined( var_5 ) )
        {
            var_9 = var_8 getnoaltweapon();

            if ( var_9.inventorytype != "_encstr_987F080E394BDAC2E45E" )
                continue;

            var_5 = var_8;
        }
    }

    if ( isdefined( var_3 ) )
    {
        var_0 scripts\cp_mp\utility\inventory_utility::_takeweapon( var_3 );
        var_0._id_12D53 = var_3;
        var_0._id_12D4F = var_4;

        if ( istrue( var_4 ) )
            _id_141F2( var_0, var_1, var_2 );

        var_0 scripts\mp\class::riotshieldonweaponchange( var_5 );
        var_0 notify( "_encstr_BE49158BAF8878B8D08D825FC2AA075BD932CA393DE2D5" );
        var_0 endon( "_encstr_BE49158BAF8878B8D08D825FC2AA075BD932CA393DE2D5" );
        var_0 childthread scripts\cp_mp\utility\inventory_utility::forcevalidweapon( var_5 );
    }
}

_id_141ED( var_0, var_1, var_2 )
{
    if ( isdefined( var_0._id_12D53 ) )
    {
        if ( !istrue( var_1 ) && !istrue( var_2 ) )
        {
            var_0 scripts\cp_mp\utility\inventory_utility::_giveweapon( var_0._id_12D53 );
            var_0 scripts\mp\class::_id_13C5C();

            if ( istrue( var_0._id_12D4F ) )
            {
                var_0 notify( "_encstr_BE49158BAF8878B8D08D825FC2AA075BD932CA393DE2D5" );
                var_0 endon( "_encstr_BE49158BAF8878B8D08D825FC2AA075BD932CA393DE2D5" );
                var_0 childthread scripts\cp_mp\utility\inventory_utility::_switchtoweaponimmediate( var_0._id_12D53 );
            }
        }

        var_0._id_12D53 = undefined;
        var_0._id_12D4F = undefined;
        var_0 notify( "_encstr_BE49158BAF8878B8D08D825FC2AA075BD932CA393DE2D5" );
    }
}

_id_141F2( var_0, var_1, var_2 )
{
    if ( isdefined( var_0._id_12D53 ) && istrue( var_0._id_12D4F ) )
    {
        if ( !isdefined( var_2 ) )
            return;

        if ( scripts\cp_mp\vehicles\vehicle_occupancy::_id_141DF( var_1, var_2 ) )
            return;

        if ( scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_shouldhideoccupantforseat( var_1, var_2 ) )
            return;

        var_3 = scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_getleveldataforseat( var_1.vehiclename, var_2 );

        if ( isdefined( var_3._id_13E8A ) )
            return;

        var_0._id_12D4F = undefined;
    }
}

_id_141F3( var_0 )
{
    if ( !var_0 getscriptablehaspart( "_encstr_956C0AE61D8589A5D8B4D1CB" ) )
        return;

    var_1 = scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_getalloccupants( var_0 );
    var_2 = var_0 vehicle_getspeed();

    if ( var_1.size > 0 )
        var_0 setscriptablepartstate( "_encstr_956C0AE61D8589A5D8B4D1CB", "_encstr_826D07DCE85889B12B", 1 );
    else if ( var_1.size == 0 && var_2 > 10 )
        var_0 setscriptablepartstate( "_encstr_956C0AE61D8589A5D8B4D1CB", "_encstr_B1090958122A11D18B64BD", 1 );
}

_id_141F1( var_0 )
{
    if ( !level.vehicle._id_1424E )
        return;

    if ( !_id_141E6() )
        return;

    if ( !var_0 getscriptablehaspart( "_encstr_B38A07C696D9A13ACD" ) )
        return;

    if ( !isdefined( var_0.showmapchyron ) )
        var_0.showmapchyron = 0;

    var_1 = scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_getalloccupants( var_0 );

    if ( var_1.size > 0 && !var_0.showmapchyron )
    {
        var_0 setscriptablepartstate( "_encstr_B38A07C696D9A13ACD", "_encstr_9707035F3B", 1 );
        var_0.showmapchyron = 1;
    }
    else if ( var_1.size == 0 && var_0.showmapchyron )
    {
        var_0 setscriptablepartstate( "_encstr_B38A07C696D9A13ACD", "_encstr_9819045FD029", 1 );
        var_0.showmapchyron = 0;
    }
}

_id_141E6()
{
    switch ( level.script )
    {
        case "_encstr_A6FF0BC368C148B6DB523018AA":
        case "_encstr_A6341077402EAAEB6F61873EDB3BE27971B0":
        case "_encstr_AD330E92C0FF67F7599F58450EE6C3AD":
            return 1;
        default:
            break;
    }

    return 0;
}

vehicle_occupancy_mp_registersentient( var_0 )
{
    var_1 = scripts\cp_mp\vehicles\vehicle_occupancy::vehicle_occupancy_getleveldataforvehicle( var_0.vehiclename );

    if ( !isdefined( var_1.threatbiasgroup ) )
        return;

    if ( level.teambased )
    {
        var_2 = var_0.team;

        if ( isdefined( var_0.team ) && var_0.team == "_encstr_9BA4080D39CFFB5AB7C1" )
            var_2 = undefined;

        if ( !isdefined( var_2 ) && isdefined( var_0.owner ) )
            var_2 = var_0.owner.team;

        if ( isdefined( var_2 ) )
        {
            if ( !isdefined( var_0.sentientteam ) || var_0.sentientteam != var_2 )
            {
                vehicle_occupancy_mp_unregistersentient( var_0 );
                var_0 scripts\mp\sentientpoolmanager::registersentient( var_1.threatbiasgroup, var_2 );
                var_0.sentientteam = var_2;
            }
        }
        else if ( isdefined( var_0.sentientteam ) )
            vehicle_occupancy_mp_unregistersentient( var_0 );
    }
}

vehicle_occupancy_mp_unregistersentient( var_0 )
{
    var_0 notify( "_encstr_A87B1062E1030FD35FD706A2B8338197030B" );
    var_0.sentientteam = undefined;
}

vehicle_occupancy_mp_issentient( var_0 )
{
    return isdefined( var_0.sentientteam );
}
