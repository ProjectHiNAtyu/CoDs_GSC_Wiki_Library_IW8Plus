// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

wristrocketinit()
{
    level._effect["_encstr_B2F114CB0387A6B88A7FCFD79DF319652BBB2070CAEF"] = loadfx( "_encstr_B6AE34EC99F0F2B4BB6EF2EB93CA8B57AC9B3ACDF2B5C1E583DEBB9539793B99F07DDD9C96DC47D793DB1BB5B2D1FA5987E0B8D933E1" );
    level._effect["_encstr_B43815A38222CA83D59D7F2F71CD2F3DDBDADD5F598D95"] = loadfx( "_encstr_B958355D5CD8C8483FBFF8262B877FC7F7A69B8FDF9A79DE1B77F38FEB925BC6309FCBC0737771D1D33D095A1144070362EB9306CBB163" );
}

wristrocket_set()
{
    thread wristrocket_watcheffects();
}

wristrocket_unset()
{
    self notify( "_encstr_B68D12D4F2FA8FEB32E74810D74CC6CBF2DA45DD" );
}

wristrocketused( var_0 )
{
    if ( var_0.tickpercent == 1 )
        return;

    var_1 = wristrocket_createrocket( var_0 );
    var_1.grenade = var_0;
    var_0 = scripts\mp\utility\weapon::_launchgrenade( "_encstr_970F0EE3A041D9E66F48B47B63E1A071", self.origin, ( 0, 0, 0 ), 100, 1, var_0 );
    var_0 forcehidegrenadehudwarning( 1 );
    var_0 linkto( var_1 );
    var_0 thread wristrocket_cleanuponparentdeath( var_1 );
    var_0 thread wristrocket_cleanuponownerdisconnect( self );
    var_1 setscriptablepartstate( "_encstr_88690789E6EB65D9D8", "_encstr_B30B07E216CBFFC4C2", 0 );
    var_1 thread wristrocket_watchfuse( 2 );
    var_1 thread wristrocket_watchstuck();
}

wristrocket_watchfuse( var_0 )
{
    self endon( "_encstr_A3750609A5E61883" );
    self.owner endon( "_encstr_8A820B4696CDB1ED3737AC1B3A" );
    self notify( "_encstr_8FD1165713875B633BD75A92DD1017DC9791AF324DDDB3DF" );
    self endon( "_encstr_8FD1165713875B633BD75A92DD1017DC9791AF324DDDB3DF" );
    wait( var_0 );
    thread wristrocket_explode();
}

wristrocket_watchstuck()
{
    self endon( "_encstr_A3750609A5E61883" );
    self.owner endon( "_encstr_8A820B4696CDB1ED3737AC1B3A" );
    self waittill( "_encstr_8AE90E7D08B8538A21DB77CF1155D2B3", var_0 );

    if ( isplayer( var_0 ) )
        self.owner scripts\mp\weapons::grenadestuckto( self, var_0 );

    self stoploopsound();
    self setscriptablepartstate( "_encstr_94AD0637D1EA6CAD", "_encstr_B30B07E216CBFFC4C2", 0 );
    self setscriptablepartstate( "_encstr_82380726952CB17B73", "_encstr_B30B07E216CBFFC4C2", 0 );
    self.grenade forcehidegrenadehudwarning( 0 );
    thread wristrocket_watchfuse( 1.35 );
}

wristrocket_explode()
{
    self setscriptablepartstate( "_encstr_94AD0637D1EA6CAD", "_encstr_9BA4080D39CFFB5AB7C1", 0 );
    self setscriptablepartstate( "_encstr_82380726952CB17B73", "_encstr_9BA4080D39CFFB5AB7C1", 0 );
    self setscriptablepartstate( "_encstr_AB0808DFB97F822F1899", "_encstr_B30B07E216CBFFC4C2", 0 );
    thread wristrocket_delete();
}

wristrocket_delete()
{
    self notify( "_encstr_A3750609A5E61883" );
    self.exploding = 1;
    wait 0.1;
    self delete();
}

wristrocket_createrocket( var_0 )
{
    var_1 = scripts\cp_mp\utility\weapon_utility::_magicbullet( getcompleteweaponname( "_encstr_9DDA13EB9009312B3066BBAD855E6B024FD081B2D0" ), var_0.origin, var_0.origin + anglestoforward( self getgunangles() ), self );
    var_1.owner = self;
    var_1.team = self.team;
    var_1.weapon_name = "_encstr_9DDA13EB9009312B3066BBAD855E6B024FD081B2D0";
    var_1.power = "_encstr_975E1202F0A07D33A0E7CB5F17DDFBBFD8D8FF8B";
    var_1 setotherent( self );
    var_1 setentityowner( self );
    var_1 thread wristrocket_cleanuponownerdisconnect( self );
    return var_1;
}

wristrocket_watcheffects()
{
    self endon( "_encstr_8A820B4696CDB1ED3737AC1B3A" );
    self notify( "_encstr_8B5319BC5304B2EDD9056737425361D7A2633E425D78678902AC96" );
    self endon( "_encstr_8B5319BC5304B2EDD9056737425361D7A2633E425D78678902AC96" );
    var_0 = 0;

    for (;;)
    {
        var_1 = spawnstruct();

        if ( var_0 )
            childthread wristrocket_watcheffectsraceheldoffhandbreak( var_1 );
        else
            childthread wristrocket_watcheffectsracegrenadepullback( var_1 );

        childthread wristrocket_watcheffectsracegrenadefired( var_1 );
        childthread wristrocket_watcheffectsracesuperstarted( var_1 );
        childthread wristrocket_watcheffectsracedeath( var_1 );
        childthread wristrocket_watcheffectsraceunset( var_1 );
        var_0 = 0;
        self waittill( "_encstr_889E2204222A5F3BE217B8C007FC969F724BF6037772CD41BB133001FF03E98F4BB6F695" );
        waittillframeend;
        var_2 = istrue( var_1.grenadepullback );
        var_3 = istrue( var_1.grenadefire );
        var_4 = istrue( var_1.superstarted );
        var_5 = istrue( var_1.death );
        var_6 = istrue( var_1.unset );
        var_7 = istrue( var_1.heldoffhandbreak );

        if ( var_5 )
        {
            self notify( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );
            thread wristrocket_endeffects();
            return;
        }
        else if ( var_6 )
        {
            self notify( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );
            thread wristrocket_endeffects();
            return;
        }
        else if ( var_4 )
            thread wristrocket_endeffects();
        else if ( var_7 )
            thread wristrocket_endeffects();
        else if ( var_3 )
            thread wristrocket_endeffects();
        else if ( var_2 )
        {
            thread wristrocket_begineffects();
            var_0 = 1;
        }

        self notify( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );
    }
}

wristrocket_watcheffectsracegrenadepullback( var_0 )
{
    self endon( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );

    for (;;)
    {
        self waittill( "_encstr_BD9B114A738DFB1E689B07108310650327C902", var_1 );

        if ( var_1.basename == "_encstr_970F0EE3A041D9E66F48B47B63E1A071" )
            break;
    }

    var_0.grenadepullback = 1;
    self notify( "_encstr_889E2204222A5F3BE217B8C007FC969F724BF6037772CD41BB133001FF03E98F4BB6F695" );
}

wristrocket_watcheffectsracegrenadefired( var_0 )
{
    self endon( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );

    for (;;)
    {
        self waittill( "_encstr_AD620DEC4ECA7358912BAF99B43959", var_1, var_2 );

        if ( var_2.basename == "_encstr_970F0EE3A041D9E66F48B47B63E1A071" )
            break;
    }

    var_0.grenadefire = 1;
    self notify( "_encstr_889E2204222A5F3BE217B8C007FC969F724BF6037772CD41BB133001FF03E98F4BB6F695" );
}

wristrocket_watcheffectsracesuperstarted( var_0 )
{
    self endon( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );
    self waittill( "_encstr_88E30E37BA0E5939EBE63A16C9D19591" );
    var_0.superstarted = 1;
    self notify( "_encstr_889E2204222A5F3BE217B8C007FC969F724BF6037772CD41BB133001FF03E98F4BB6F695" );
}

wristrocket_watcheffectsracedeath( var_0 )
{
    self endon( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );
    self waittill( "_encstr_A3750609A5E61883" );
    var_0.death = 1;
    self notify( "_encstr_889E2204222A5F3BE217B8C007FC969F724BF6037772CD41BB133001FF03E98F4BB6F695" );
}

wristrocket_watcheffectsraceunset( var_0 )
{
    self endon( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );
    self waittill( "_encstr_B68D12D4F2FA8FEB32E74810D74CC6CBF2DA45DD" );
    var_0.unset = 1;
    self notify( "_encstr_889E2204222A5F3BE217B8C007FC969F724BF6037772CD41BB133001FF03E98F4BB6F695" );
}

wristrocket_watcheffectsraceheldoffhandbreak( var_0 )
{
    self endon( "_encstr_A147207B4364EA3383AA0FD2476B1FE3E19B2EA89F908B851F531B261019F21DFDA7" );
    waitframe();
    var_1 = getcompleteweaponname( "_encstr_970F0EE3A041D9E66F48B47B63E1A071" );

    while ( self getheldoffhand() == var_1 )
        waitframe();

    var_0.heldoffhandbreak = 1;
    self notify( "_encstr_889E2204222A5F3BE217B8C007FC969F724BF6037772CD41BB133001FF03E98F4BB6F695" );
}

wristrocket_begineffects()
{
    self notify( "_encstr_81FA192C9B7A132B8D18F03FD299694B208852DE8F995707C734A6" );
    self endon( "_encstr_81FA192C9B7A132B8D18F03FD299694B208852DE8F995707C734A6" );
    self endon( "_encstr_A61117D3EB1367B32167A3A31B783167C881484AF1FDEF6B10" );
    self setscriptablepartstate( "_encstr_B4F711A735980A0BF608DA42513D4FC5B8E12C", "_encstr_9BA4080D39CFFB5AB7C1", 0 );
    wait 0.15;
    self setscriptablepartstate( "_encstr_B4F711A735980A0BF608DA42513D4FC5B8E12C", "_encstr_B30B07E216CBFFC4C2", 0 );
}

wristrocket_endeffects()
{
    self notify( "_encstr_A61117D3EB1367B32167A3A31B783167C881484AF1FDEF6B10" );
    self setscriptablepartstate( "_encstr_B4F711A735980A0BF608DA42513D4FC5B8E12C", "_encstr_9BA4080D39CFFB5AB7C1", 0 );
}

wristrocketcooksuicideexplodecheck( var_0, var_1, var_2, var_3, var_4 )
{
    if ( var_1 != var_2 )
        return;

    if ( var_3 != "_encstr_97590CFD0825D7720BD1A018A1F3" )
        return;

    if ( !isdefined( var_0 ) || var_0 != var_1 )
        return;

    if ( !isdefined( var_4 ) || var_4.basename != "_encstr_970F0EE3A041D9E66F48B47B63E1A071" )
        return;

    var_5 = var_2 gettagorigin( "_encstr_9D8C101DB0CE7DEE95581CBDE6FAB195CC47" );
    radiusdamage( var_5, 175, 200, 70, var_1, "_encstr_A45C0E4B9FDF3165A3B93C4491BFA4A9", "_encstr_970F0EE3A041D9E66F48B47B63E1A071" );
    scripts\mp\shellshock::grenade_earthquakeatposition( var_5, 0.6 );
    playfx( scripts\engine\utility::getfx( "_encstr_B2F114CB0387A6B88A7FCFD79DF319652BBB2070CAEF" ), var_5 );
}

wristrocket_cleanuponparentdeath( var_0, var_1 )
{
    self endon( "_encstr_A3750609A5E61883" );
    self notify( "_encstr_AD93153E69DAB1D0903A703001F82BCDF87398A367C9E8" );
    self endon( "_encstr_AD93153E69DAB1D0903A703001F82BCDF87398A367C9E8" );

    if ( isdefined( var_0 ) )
        var_0 waittill( "_encstr_A3750609A5E61883" );

    if ( isdefined( var_1 ) )
        wait( var_1 );

    self delete();
}

wristrocket_cleanuponownerdisconnect( var_0 )
{
    self endon( "_encstr_A3750609A5E61883" );
    var_0 waittill( "_encstr_8A820B4696CDB1ED3737AC1B3A" );

    if ( isdefined( self ) )
        self delete();
}
