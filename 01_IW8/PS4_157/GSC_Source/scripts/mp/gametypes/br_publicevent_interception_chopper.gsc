// IW8 GSC SOURCE
// Generated by https://github.com/xensik/gsc-tool

init()
{
    var_0 = spawnstruct();
    var_0.attackerswaittime = ::ascendermodelview;
    var_0.isfeaturedisabled = ::deactivate;
    var_0._id_14382 = ::_id_14382;
    var_0.weight = getdvarfloat( "scr_br_pe_interception_weight", 0 );
    var_0._id_11B78 = getdvarint( "scr_br_pe_interception_max_times", 0 );
    var_0.guard_door_clip = scripts\mp\gametypes\br_publicevents.gsc::relic_squadlink_init_vfx( "interception", "0   20  20  20          0  0 0  0" );
    scripts\mp\gametypes\br_publicevents.gsc::_id_12B35( 17, var_0 );
    tr_vis_radius_override_lod2();
    initloottables();
    _testing_ending::teamplunderexfiltimer();
    scripts\engine\scriptable::_id_12F5B( "scriptable_interception_bag", ::chopper_bag_used );
}

tr_vis_radius_override_lod2()
{
    level._id_12E2B = spawnstruct();
    level._id_12E2B.a_s_event_locations = get_possible_event_locations();
    level._id_12E2B.a_v_used_event_locations = [];
    level._id_12E2B.sg_ontimerexpired = getdvarint( "scr_interception_hasLootPinata", 1 );
    level._id_12E2B._id_11F1F = getdvarint( "scr_interception_numEnemyAgents", 5 );
    level._id_12E2B.spawnregions = getdvarint( "scr_interception_chopperWaitTime", 120 );
    level._id_12E2B.pre_pinata_uses = getdvarint( "scr_interception_prePinataUses", 4 );
    level._id_12E2B.cash_looted_xp_small = getdvarint( "scr_interception_cashLootedXpSmall", 50 );
    level._id_12E2B.cash_looted_xp_large = getdvarint( "scr_interception_cashLootedXpLarge", 100 );
    level._id_12E2B.cash_aliases = [ "cashlootsm", "cashlootmd", "cashlootlrg", "cashlootepic", "cashlootlegend" ];
    var_0 = getdvar( "scr_interception_minCashRewards", "" );
    level._id_12E2B.min_cash_rewards = [];

    if ( var_0 != "" )
    {
        var_1 = strtok( var_0, " " );

        foreach ( var_3 in var_1 )
            level._id_12E2B.min_cash_rewards[level._id_12E2B.min_cash_rewards.size] = int( var_3 );
    }
    else
        level._id_12E2B.min_cash_rewards = [ 15, 0, 0, 0, 0 ];

    var_5 = getdvar( "scr_interception_maxCashRewards", "" );
    level._id_12E2B.max_cash_rewards = [];

    if ( var_5 != "" )
    {
        var_6 = strtok( var_5, " " );

        foreach ( var_3 in var_6 )
            level._id_12E2B.max_cash_rewards[level._id_12E2B.max_cash_rewards.size] = float( var_3 );
    }
    else
        level._id_12E2B.max_cash_rewards = [ 25, 0, 0, 0, 0 ];

    if ( level._id_12E2B.max_cash_rewards.size != level._id_12E2B.cash_aliases.size || level._id_12E2B.min_cash_rewards.size != level._id_12E2B.cash_aliases.size )
    {

    }

    level._id_12E2B._id_11BAB = [ "brloot_plunder_cash_uncommon_1", "brloot_plunder_cash_uncommon_2", "brloot_plunder_cash_uncommon_3" ];
    level._id_12E2B.waitteardowninfilmapomnvars = [ "brloot_plunder_cash_rare_1", "brloot_plunder_cash_rare_2" ];
    level._id_12E2B._id_14292 = [ "brloot_plunder_cash_epic_1", "brloot_plunder_cash_epic_2" ];
    level._id_12E2B.ammo_objects = [ "brloot_ammo_12g", "brloot_ammo_50cal", "brloot_ammo_rocket", "brloot_ammo_919", "brloot_ammo_762" ];
    level._id_12E2B.hascircle = !level.br_circle_disabled;
    level._effect["vfx_smk_signal_green"] = loadfx( "vfx/iw8_cp/prop/vfx_smk_signal_green" );
}

initloottables()
{
    var_0 = [];

    switch ( getdvar( "mapname" ) )
    {
        default:
            switch ( scripts\mp\utility\game::getgametype() )
            {
                default:
                    var_0["brloot_offhand_kioskdrop"] = 1;
                    var_0["brloot_offhand_advancedsupplydrop"] = 1;
                    var_0["brloot_killstreak_uav"] = 1;
                    var_0["brloot_offhand_jammer"] = 1;
                    var_0["brloot_super_munitionsbox"] = 1;
                    var_0["brloot_plate_pouch"] = 1;
                    var_0["brloot_offhand_decon_station"] = 1;
            }

            break;
    }

    _handlevehiclerepair::_id_11A45( "interception_final_pinata", var_0 );
}

get_possible_event_locations()
{
    var_0 = [];

    switch ( getdvar( "mapname" ) )
    {
        case "mp_sm_island_1":
            var_0[var_0.size] = _id_12ADE( ( -146, -246, 1317 ), [], 100 );
            var_0[var_0.size] = _id_12ADE( ( -5646, 2356, 1276 ), [], 100 );
            var_0[var_0.size] = _id_12ADE( ( 9991, 5704, 130 ), [], 100 );
            break;
        default:
            var_0[var_0.size] = _id_12ADE( ( -146, -246, 20 ), [ [ ( -146, -246, 0 ), ( 146, -246, 0 ) ], [ ( -246, -146, 0 ), ( 246, -146, 0 ) ] ], 100 );
            var_0[var_0.size] = _id_12ADE( ( 0, -246, 20 ), [ [ ( -146, -246, 0 ), ( 146, -246, 0 ) ], [ ( -246, -146, 0 ), ( 246, -146, 0 ) ] ], 100 );
            var_0[var_0.size] = _id_12ADE( ( 146, -246, 20 ), [ [ ( -146, -246, 0 ), ( 146, -246, 0 ) ], [ ( -246, -146, 0 ), ( 246, -146, 0 ) ] ], 100 );
            break;
    }

    return var_0;
}

_id_12ADE( var_0, var_1, var_2 )
{
    var_3 = spawnstruct();
    var_3.minecart_run = var_0;
    var_3.patrol_paths = var_1;
    var_3.minigun_internal = var_2;
    var_3._id_13B91 = 0;
    var_3.new_rider_combat_logic = [];
    return var_3;
}

ascendermodelview()
{
    level._id_12E2B.a_s_event_locations = scripts\engine\utility::array_randomize( level._id_12E2B.a_s_event_locations );
    var_0 = undefined;
    var_1 = 0;

    if ( level._id_12E2B.hascircle )
        var_1 = scripts\mp\gametypes\br_circle.gsc::inithelirepository() < 45 && !scripts\mp\gametypes\br_circle.gsc::islastcircle();

    foreach ( var_3 in level._id_12E2B.a_s_event_locations )
    {
        if ( !level._id_12E2B.hascircle )
        {
            if ( !scripts\engine\utility::array_contains( level._id_12E2B.a_v_used_event_locations, var_3.minecart_run ) )
                var_0 = var_3;

            continue;
        }

        if ( var_1 )
        {
            if ( scripts\mp\gametypes\br_circle.gsc::updatescavengerhud( var_3.minecart_run ) && !scripts\engine\utility::array_contains( level._id_12E2B.a_v_used_event_locations, var_3.minecart_run ) )
                var_0 = var_3;

            continue;
        }

        if ( scripts\mp\gametypes\br_circle.gsc::ispointincurrentsafecircle( var_3.minecart_run ) && !scripts\engine\utility::array_contains( level._id_12E2B.a_v_used_event_locations, var_3.minecart_run ) )
            var_0 = var_3;
    }

    if ( isdefined( var_0 ) )
    {
        foreach ( var_6 in level.players )
            var_6 thread scripts\mp\hud_message::showsplash( "br_pe_interception_start" );

        level._id_12E2B.a_v_used_event_locations[level._id_12E2B.a_v_used_event_locations.size] = var_0.minecart_run;
        thread _id_13794( var_0 );
    }
}

deactivate()
{

}

_id_14382()
{
    level endon( "game_ended" );
    level endon( "cancel_public_event" );

    if ( getdvarint( "scr_br_loadout_delay", 0 ) == 1 && level.br_circle.circleindex <= 1 )
        level waittill( "br_circle_closing" );
}

_id_13794( var_0 )
{
    var_1 = randomfloat( 360 );
    var_2 = var_0.minecart_run + -1 * anglestoforward( ( 0, var_1, 0 ) ) * 4000 + ( 0, 0, 3000 );
    var_3 = vectortoangles( var_0.minecart_run - var_2 );
    var_4 = 99;
    var_5 = scripts\cp_mp\vehicles\vehicle_tracking::_spawnhelicopter( level.players[randomint( level.players.size )], var_2, var_3, "veh_apache_plunder_mp", "veh8_mil_air_mindia8_plunder_x" );

    if ( !isdefined( var_5 ) )
        return;

    var_6 = var_0.minecart_run * ( 1, 1, 0 ) + ( 0, 0, 3000 );
    var_0.heli = var_5;
    var_5._id_11980 = var_0;
    var_5.damagecallback = ::callback_vehicledamage;
    var_5.speed = 50;
    var_5.accel = 125;
    var_5.health = 10000;
    var_5.maxhealth = var_5.health;
    var_5.defendloc = var_0.minecart_run;
    var_5.lifeid = 0;
    var_5.flaresreservecount = var_4;
    var_5.pathgoal = var_6;
    var_5._id_121FF = var_0.minecart_run + anglestoforward( var_3 ) * 4000 + ( 0, 0, 3000 );
    var_5.endpoint = var_6;
    var_5.select_mountain_two_spawners = var_3[1];
    var_5.vehiclename = "magma_plunder_chopper";
    var_5 setcandamage( 1 );
    var_5 setmaxpitchroll( 10, 25 );
    var_5 vehicle_setspeed( var_5.speed, var_5.accel );
    var_5 sethoverparams( 50, 100, 50 );
    var_5 setturningability( 0.05 );
    var_5 setyawspeed( 45, 25, 25, 0.5 );
    _id_13693( var_5 );
    var_5 thread showquestcircletoplayer();
    var_5 thread handledestroydamage();
    var_5 thread givebrbonusxp();
    var_5 thread givebrweaponxp();
}

givebrweaponxp()
{
    self endon( "death" );
    self endon( "leaving" );
    self setvehgoalpos( self.pathgoal, 1 );
    self settargetyaw( self.select_mountain_two_spawners );
    var_0 = givequestsplash( self.pathgoal, self._id_11980 );
    thread heli_spawn_smoke_marker();
    self waittill( "goal" );
    thread givespecialistbonusifneeded();
    givebmodevloadouts( self.endpoint, var_0 );
}

heli_spawn_smoke_marker()
{
    var_0 = spawn( "script_model", self._id_11980.ground_drop_point - ( 0, 0, 3 ) );
    var_0 setmodel( "tag_origin" );
    self.smokevfxent = var_0;
    wait 1.0;
    playfxontag( scripts\engine\utility::getfx( "vfx_smk_signal_green" ), var_0, "tag_origin" );
}

givebmodevloadouts( var_0, var_1 )
{
    self endon( "death" );
    var_2 = var_0[0];
    var_3 = var_0[1];
    var_4 = ( var_2, var_3, var_1 );
    self setvehgoalpos( var_4, 1 );
    self settargetyaw( self.select_mountain_two_spawners );
    self vehicle_setspeed( 25.0, 31.25 );
    thread chopper_start_agent_spawn();
    self waittill( "goal" );
    self sethoverparams( 1, 1 );
    thread giverandomloadoutindex();
}

chopper_start_agent_spawn()
{
    wait 3;

    for ( var_0 = 0; var_0 < level._id_12E2B._id_11F1F; var_0++ )
    {
        var_1 = spawn_guard_agent( self._id_11980.minecart_run + ( 5, 5, 1 ), ( 0, 0, 180 ), self._id_11980.minigun_internal, 1, "actor_enemy_lw_br", "team_twenty" );

        if ( var_0 < self._id_11980.patrol_paths.size )
            var_1.patrolpathpoints = self._id_11980.patrol_paths[var_0];

        self._id_11980.new_rider_combat_logic = scripts\engine\utility::array_add( self._id_11980.new_rider_combat_logic, var_1 );
    }
}

giverandomloadoutindex()
{
    self endon( "death" );
    self endon( "leaving" );
    wait( level._id_12E2B.spawnregions );
    thread givequestreward();
}

chopper_bag_used( var_0, var_1, var_2, var_3, var_4 )
{
    var_0 endon( "death" );
    var_0 endon( "leaving" );
    var_0.entity._id_11980.heli endon( "leaving" );
    var_5 = level._id_12E2B.pre_pinata_uses + level._id_12E2B.sg_ontimerexpired;
    var_6 = scripts\mp\gametypes\br_pickups.gsc::test_ai_anim();
    var_7 = var_0.entity _id_13C2D( var_0.origin, 100, [ var_0.entity ] );
    var_8 = var_7[2] + 2;
    var_0.entity._id_11980._id_13B91++;

    if ( var_0.entity._id_11980._id_13B91 >= var_5 )
    {
        var_0 setscriptablepartstate( "scriptable_interception_bag", "unusable" );

        if ( level._id_12E2B.sg_ontimerexpired )
        {
            level thread _handlevehiclerepair::_id_13673( "interception_final_pinata", ( var_0.origin[0], var_0.origin[1], var_8 ), randomint( 3 ) + 2, 0 );
            var_3 thread scripts\mp\rank::giverankxp( "br_pe_interception_bag_looted", level._id_12E2B.cash_looted_xp_large );
        }
        else
        {
            chopper_gunner_assigntargetmarkers( level._id_12E2B.get_train_travel_time_between_stations[var_0.entity._id_11980._id_13B91 - 1], var_0.entity, var_6, var_8, 1, 1 );
            var_3 thread scripts\mp\rank::giverankxp( "br_pe_interception_bag_looted", level._id_12E2B.cash_looted_xp_small );
        }

        var_0.entity._id_11980.heli thread givequestreward();
    }
    else
    {
        chopper_gunner_assigntargetmarkers( var_0.entity, var_6, var_8, 1, 1 );
        var_3 thread scripts\mp\rank::giverankxp( "br_pe_interception_bag_looted", level._id_12E2B.cash_looted_xp_small );

        if ( var_0.entity._id_11980._id_13B91 == 2 )
            var_0.entity._id_11980.heli chopper_start_agent_spawn();
    }
}

givespecialistbonusifneeded()
{
    self endon( "death" );
    self endon( "leaving" );
    level waittill( "game_ended" );
    thread givequestreward();
}

givequestreward()
{
    self endon( "death" );
    self notify( "leaving" );
    self.leaving = 1;

    foreach ( var_1 in level.players )
        var_1 thread scripts\mp\hud_message::showsplash( "br_pe_interception_end" );

    self sethoverparams( 25, 20, 10 );
    self setvehgoalpos( self.pathgoal, 1 );
    self settargetyaw( self.select_mountain_two_spawners );
    self waittill( "goal" );
    self vehicle_setspeed( self.speed, self.accel );
    self setvehgoalpos( self._id_121FF, 1 );
    self settargetyaw( self.select_mountain_two_spawners );
    self waittill( "goal" );
    self stoploopsound();
    self notify( "heli_gone" );
    level thread chopper_despawn_agents_think( self._id_11980 );
    giveachievementsmoke();
    giveawardfake();
}

chopper_despawn_agents_think( var_0 )
{
    level endon( "game_ended" );
    wait 10;
    var_1 = 1000000;

    for (;;)
    {
        var_2 = 1;

        foreach ( var_4 in level.players )
        {
            if ( !isdefined( var_4 ) || !scripts\mp\utility\player::isreallyalive( var_4 ) )
                continue;

            if ( distancesquared( var_4.origin, var_0.minecart_run ) < var_1 )
            {
                var_2 = 0;
                break;
            }
        }

        if ( var_2 )
        {
            foreach ( var_7 in var_0.new_rider_combat_logic )
            {
                if ( isdefined( var_7 ) && isalive( var_7 ) )
                    var_7 despawnagent();
            }

            return;
        }

        wait 1;
    }
}

callback_vehicledamage( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11, var_12 )
{
    if ( isdefined( var_1 ) )
    {
        if ( isdefined( var_1.owner ) )
            var_1 = var_1.owner;
    }

    if ( var_1 == self )
        return;

    if ( self.health <= 0 )
        return;

    var_2 = scripts\mp\utility\killstreak::getmodifiedantikillstreakdamage( var_1, var_5, var_4, var_2, self.maxhealth, 3, 4, 5 );
    scripts\mp\killstreaks\killstreaks::killstreakhit( var_1, var_5, self, var_4, var_2 );
    var_1 scripts\mp\damagefeedback::updatedamagefeedback( "" );

    if ( self.health - var_2 <= 900 && ( !isdefined( self.smoking ) || !self.smoking ) )
        self.smoking = 1;

    self vehicle_finishdamage( var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11 );
}

chopper_gunner_assigntargetmarkers( var_0, var_1, var_2, var_3, var_4 )
{
    var_5 = [];

    if ( var_3 )
    {
        var_6 = randomintrange( 1, 3 );

        for ( var_7 = 0; var_7 < var_6; var_7++ )
            var_5[var_5.size] = "brloot_armor_plate";
    }

    if ( var_4 )
    {
        var_8 = randomintrange( 1, 3 );

        for ( var_7 = 0; var_7 < var_8; var_7++ )
        {
            var_9 = randomintrange( 0, level._id_12E2B.ammo_objects.size );
            var_5[var_5.size] = level._id_12E2B.ammo_objects[var_9];
        }
    }

    for ( var_7 = 0; var_7 < level._id_12E2B.cash_aliases.size; var_7++ )
    {
        var_10 = randomintrange( level._id_12E2B.min_cash_rewards[var_7], level._id_12E2B.max_cash_rewards[var_7] + 1 );

        for ( var_11 = 0; var_11 < var_10; var_11++ )
            var_5[var_5.size] = level._id_12E2B.cash_aliases[var_7];
    }

    scripts\engine\utility::array_randomize( var_5 );

    foreach ( var_13 in var_5 )
    {
        var_14 = scripts\mp\gametypes\br_pickups.gsc::getitemdroporiginandangles( var_1, ( var_0.origin[0], var_0.origin[1], var_2 ), var_0.angles, var_0 );
        var_15 = "";

        switch ( var_13 )
        {
            case "cashlootsm":
                var_15 = "brloot_plunder_cash_common_1";
                break;
            case "cashlootmd":
                var_15 = scripts\engine\utility::random( level._id_12E2B._id_11BAB );
                break;
            case "cashlootlrg":
                var_15 = scripts\engine\utility::random( level._id_12E2B.waitteardowninfilmapomnvars );
                break;
            case "cashlootepic":
                var_15 = scripts\engine\utility::random( level._id_12E2B._id_14292 );
                break;
            case "cashlootlegend":
                var_15 = "brloot_plunder_cash_legendary_1";
                break;
            default:
                var_15 = var_13;
                break;
        }

        var_16 = scripts\mp\gametypes\br_pickups.gsc::spawnpickup( var_15, var_14, 1, 1 );
    }
}

showquestcircletoplayer()
{
    self endon( "death" );
    self endon( "leaving" );
    self endon( "swapped" );

    for (;;)
        self waittill( "damage", var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11, var_12, var_13 );
}

givebrbonusxp()
{
    self endon( "heli_gone" );
    self endon( "swapped" );
    var_0 = self.owner;
    var_1 = self.team;
    self waittill( "death", var_2, var_3, var_4, var_5 );

    foreach ( var_7 in level.players )
        var_7 thread scripts\mp\hud_message::showsplash( "br_pe_interception_end" );

    giveachievementsmoke();

    if ( !isdefined( self ) )
        return;

    if ( !isdefined( self.largeprojectiledamage ) && !istrue( self.isdepot ) )
    {
        self vehicle_setspeed( 25, 5 );
        thread giveammo( 75 );
        scripts\mp\hostmigration::waitlongdurationwithhostmigrationpause( 2.7 );
    }

    if ( self._id_11980.new_rider_combat_logic.size != 0 )
        level thread chopper_despawn_agents_think( self._id_11980 );

    givelaststandifneeded( var_2 );
}

handledestroydamage()
{
    self endon( "death" );
    self endon( "leaving" );
    self endon( "swapped" );

    for (;;)
    {
        self waittill( "damage", var_0, var_1, var_2, var_3, var_4, var_5, var_6, var_7, var_8, var_9, var_10, var_11, var_12, var_13 );
        var_9 = scripts\mp\utility\weapon::mapweapon( var_9, var_13 );

        if ( ( var_9.basename == "aamissile_projectile_mp" || var_9.basename == "nuke_mp" ) && var_4 == "MOD_EXPLOSIVE" && var_0 >= self.health )
        {
            callback_vehicledamage( var_1, var_1, 9001, 0, var_4, var_9, var_3, var_2, var_3, 0, 0, var_7 );
            giveachievementwildfire();
        }
    }
}

_id_13693( var_0 )
{
    var_1 = [];
    var_1[0] = spawn( "script_model", ( 0, 0, 0 ) );
    var_1[0] setmodel( "br_plunder_extraction_delivery_rope" );
    var_1[0] linkto( var_0, "side_door_l_jnt", ( 11, 20, 42 ), ( 0, 180, 0 ) );
    var_1[1] = spawn( "script_model", ( 0, 0, 0 ) );
    var_1[1] setmodel( "br_plunder_extraction_delivery_rope" );
    var_1[1] linkto( var_1[0], "dyn_rope_end", ( 0, 0, 0 ), ( 0, 0, 0 ) );
    var_2 = spawn( "script_model", ( 0, 0, 0 ) );
    var_2 setmodel( "scriptable_interception_bag_xmodel" );
    var_2 linkto( var_1[1], "dyn_rope_end", ( 0, 0, 0 ), ( 0, 0, 0 ) );
    var_0._id_12D98 = var_1;
    var_0.crate = var_2;
    var_2._id_11980 = var_0._id_11980;
}

giveachievementsmoke()
{
    for ( var_0 = self._id_12D98.size - 1; var_0 >= 0; var_0-- )
    {
        if ( isdefined( self._id_12D98[var_0] ) )
            self._id_12D98[var_0] delete();
    }

    if ( isdefined( self.crate ) )
        self.crate delete();

    giveachievementwildfire();
}

givelaststandifneeded( var_0 )
{
    var_1 = self gettagorigin( "tag_origin" ) + ( 0, 0, 40 );
    playfx( scripts\engine\utility::getfx( "little_bird_explode" ), var_1, anglestoforward( self.angles ), anglestoup( self.angles ) );
    playsoundatpos( var_1, "veh_chopper_support_crash" );
    earthquake( 0.4, 800, var_1, 0.7 );
    playrumbleonposition( "grenade_rumble", var_1 );
    physicsexplosionsphere( var_1, 500, 200, 1 );
    self notify( "explode" );
    wait 0.35;
    giveachievementwildfire();
    giveawardfake();
}

giveawardfake()
{
    scripts\cp_mp\vehicles\vehicle_tracking::_deletevehicle( self );
}

giveammo( var_0 )
{
    self endon( "explode" );
    self notify( "heli_crashing" );
    self setvehgoalpos( self.origin + ( 0, 0, 100 ), 1 );
    scripts\mp\hostmigration::waitlongdurationwithhostmigrationpause( 1.5 );
    self setyawspeed( var_0, var_0, var_0 );
    self settargetyaw( self.angles[1] + var_0 * 2.5 );
}

giveachievementwildfire()
{
    if ( isdefined( self.vfxent ) )
    {
        self.vfxent stoploopsound();
        self.vfxent delete();
    }

    if ( isdefined( self.smokevfxent ) )
        self.smokevfxent delete();
}

givequestsplash( var_0, var_1 )
{
    var_2 = 330;
    var_3 = _id_13C2D( var_0, 100, [ self ] );
    var_4 = var_3[2];
    var_5 = var_4 + var_2;
    var_1.ground_drop_point = var_3;
    return var_5;
}

_id_13C2D( var_0, var_1, var_2 )
{
    var_3 = -99999;
    var_4 = ( var_0[0], var_0[1], var_3 );
    var_5 = scripts\engine\trace::create_world_contents();
    var_6 = undefined;

    if ( isdefined( var_1 ) )
        var_6 = scripts\engine\trace::sphere_trace( var_0, var_4, var_1, var_2, var_5 );
    else
        var_6 = scripts\engine\trace::ray_trace( var_0, var_4, var_2, var_5 );

    if ( isdefined( var_6 ) )
        return var_6["position"];
    else
        return undefined;
}

spawn_guard_agent( var_0, var_1, var_2, var_3, var_4, var_5 )
{
    if ( !isdefined( var_1 ) )
        var_1 = ( 0, 0, 0 );

    if ( !isdefined( var_4 ) )
        var_4 = "actor_enemy_lw_br";

    if ( !isdefined( var_3 ) )
        var_3 = 0;

    if ( !isdefined( var_5 ) )
        var_5 = "team_two_hundred";

    var_6 = spawnstruct();
    var_6.is_parachute_spawner = 1;
    var_7 = scripts\mp\mp_agent::spawnnewagent( var_4, var_5, var_0, var_1, scripts\mp\class::buildweapon( "iw8_ar_akilo47", [ "none", "none", "none", "none", "none", "none" ], "none", "none" ) );

    if ( !isdefined( var_7 ) )
        return;

    var_7.guid = var_7 getguid();
    var_7.goalradius = var_2;
    var_7 setgoalpos( var_0 );
    var_7 _testing_ending::ammobox_getbufferedattachmentsourceweapon();
    var_7 thread _testing_ending::alwaysdoskyspawnontacinsert();
    var_7 thread _testing_ending::activeparachutersfactionvo();
    var_7 thread _testing_ending::activestate();

    if ( var_3 )
        var_7 _testing_ending::scriptable_token_scriptable_touched_callback( 250 );

    level.deposit_from_compromised_convoy_delayed._id_1363D = scripts\engine\utility::array_add( level.deposit_from_compromised_convoy_delayed._id_1363D, var_7 );
    return var_7;
}

activate_destructible_cinderblock()
{

}
